#!/usr/bin/env bash

export CVE_PATCHES_DIR=CVE-patches
export RCLONE_DIR=rclone

set -x
env

set -e -o pipefail

# Use our customized go.mod/go.sum with:
# - replacement for golang/x/crypto to v0.45.0 for CVE-2025-47913
# - replacement for github.com/sirupsen/logrus to v1.9.1 for CVE-2025-65637
# - also includes updating jwt-go to 4.5.2
cp ${CVE_PATCHES_DIR}/rclone_patch_deps/go.mod "${RCLONE_DIR}"/go.mod
cp ${CVE_PATCHES_DIR}/rclone_patch_deps/go.sum "${RCLONE_DIR}"/go.sum

# cat "${RCLONE_DIR}"/go.mod
